{% extends "base.html" %}
{% block content %}
<h1>Explore</h1>

{% for lang in languages %}
  <h2>{{ lang.name }} ({{ lang.code }})</h2>
  {% if lang.decks.all %}
    <ul>
      {% for deck in lang.decks.all %}
      <li>
        <b>{{ deck.title }}</b>
        {% if user.is_authenticated %}
          {% if deck.in_library %}
            {% if deck.has_active_session %}
              <a class="btn btn-primary" href="{% url 'study_start' deck.id %}">
                Resume
              </a>
            {% else %}
              <span class="muted">✓ In your library</span>
            {% endif %}
          {% else %}
            <button class="btn"
              hx-post="{% url 'library_add' deck.id %}"
              hx-headers='{"X-CSRFToken":"{{ csrf_token }}"}'
              hx-swap="none">
              Add to library
            </button>
          {% endif %}
        {% endif %}
      
        <span class="muted">
          •
          {% if deck.known_cards is not None %}
            You've seen {{ deck.known_cards }} of {{ deck.total_cards }} words
          {% else %}
            {{ deck.total_cards }} cards
          {% endif %}
        </span>
      </li>
      {% endfor %}
    </ul>
  {% else %}
    <p class="muted">No decks yet.</p>
  {% endif %}
{% endfor %}
{% endblock %}
